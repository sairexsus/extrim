<!DOCTYPE html>
<html lang="ru">
<head> 
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>EXTRIM Прокачки</title>

<link rel="icon" href="https://cdn.discordapp.com/attachments/1374833926157107230/1407036280860311677/extrim-removebg-preview.png?ex=68a4a426&is=68a352a6&hm=48d922a638361441fb173d2f414fef8f5a7ebef37525d091b2ace71f21b66fe8&" type="image/png">

<style>
  :root {
    --extrim-cursor: url('https://cdn.discordapp.com/attachments/1374833926157107230/1405530445692801094/cursor_1.png?ex=68a46fbb&is=68a31e3b&hm=fd16a2c423436be8d1f5c9c8f70ae9f16fc6d9a66d2d7414e51054f2e5ba03f6&') 24 12, auto;
  }
  * { cursor: var(--extrim-cursor) !important; }

  body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: url('https://cdn.discordapp.com/attachments/1374833926157107230/1407035999942479924/photo_2025-08-12_22-54-11.jpg?ex=68a4a3e3&is=68a35263&hm=67153e25d75938066875bcde3b6eb7a86e669813bb324f85e4818120f07ca6f4&') no-repeat center center fixed;
    background-size: cover;
    display: flex;
    justify-content: center;
    padding: 20px;
    color: #eee;
    user-select: none;
    min-height: 100vh;
    background-color: rgba(0,0,0,0.6);
    background-blend-mode: multiply;
  }
  #container {
    display: flex;
    gap: 40px;
    align-items: flex-start;
  }
  #leftSide {
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  h1 {
    margin-bottom: 20px;
    color: #ffd700;
    text-shadow: 0 0 10px #ffd700;
    cursor: pointer;
  }
  #buttonsWrapper {
    display: flex;
    gap: 20px;
    margin-bottom: 20px;
  }
  .channel-btn {
    padding: 10px 25px 10px 40px;
    cursor: pointer;
    background: rgba(255,255,255,0.2);
    border-radius: 10px;
    font-weight: bold;
    color: #eee;
    user-select: none;
    transition: background-color 0.3s, color 0.3s;
    position: relative;
    display: flex;
    align-items: center;
  }
  .channel-btn.active {
    background: gold;
    color: black;
  }
  .channel-btn.disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }
  .channel-btn img {
    position: absolute;
    left: 10px;
    width: 20px;
    height: 20px;
    object-fit: contain;
    top: 50%;
    transform: translateY(-50%);
  }
  #grid {
    display: grid;
    grid-template-columns: repeat(8, 80px);
    grid-gap: 10px;
  }
  .cell {
    background: rgba(255,255,255,0.1);
    border: 2px solid rgba(255,255,255,0.3);
    border-radius: 12px;
    cursor: pointer;
    font-weight: bold;
    font-size: 24px;
    color: #b0f2b6;
    display: flex;
    align-items: center;
    justify-content: center;
    user-select: none;
    transition: background-color 0.3s, transform 0.3s;
    width: 80px;
    height: 80px;
  }
  .cell:hover:not(.opened) {
    background-color: rgba(50,255,50,0.3);
    transform: scale(1.1);
  }
  .cell.opened {
    cursor: default;
    background-color: rgba(0,0,0,0.6);
    color: #fff;
    text-shadow: 0 0 6px #0f0;
  }
  .cell.bomb {
    background-color: #ff3333 !important;
    color: white !important;
    text-shadow: 0 0 10px #ff0000;
  }
  #buttonsBottom {
    margin-top: 20px;
    display: flex;
    justify-content: center;
  }
  #rouletteBtn, #showAllBtn {
    padding: 12px 28px;
    font-size: 18px;
    border-radius: 12px;
    border: none;
    cursor: pointer;
    font-weight: bold;
    margin: 0 10px;
  }
  #rouletteBtn {
    background: gold;
    color: black;
  }
  #rouletteBtn:disabled {
    background: #666;
    color: #ccc;
    cursor: not-allowed;
  }
  #showAllBtn {
    background: #444;
    color: #eee;
  }
  #showAllBtn:disabled {
    background: #222;
    cursor: not-allowed;
    color: #555;
  }
  #rouletteWrapper {
    position: relative;
    width: 240px;
    height: 240px;
    user-select: none;
  }
  #rouletteWheel {
    width: 240px;
    height: 240px;
    border-radius: 50%;
    border: 8px solid gold;
    box-shadow: 0 0 30px gold;
    background: conic-gradient(
      #a6f5a6 0deg 180deg,
      #f5a6a6 180deg 360deg
    );
    position: relative;
    display: flex;
    justify-content: center;
    align-items: center;
    font-weight: bold;
    font-size: 18px;
    user-select: none;
    text-shadow: 0 0 5px #000;
    color: #fff;
  }
  #labelCombined {
    user-select: none;
    pointer-events: none;
    color: #fff;
    display: flex;
    gap: 8px;
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
  }
  #labelCombined .red {
    color: #a00;
    text-shadow: 0 0 8px #f00;
  }
  #labelCombined .green {
    color: #0a0;
    text-shadow: 0 0 8px #0f0;
  }
  #arrow {
    position: absolute;
    top: 50%;
    right: -50px;
    transform: translateY(-50%) rotate(-90deg);
    width: 0;
    height: 0;
    border-left: 15px solid transparent;
    border-right: 15px solid transparent;
    border-bottom: 30px solid gold;
    filter: drop-shadow(0 0 3px #fff);
    z-index: 10;
    cursor: pointer;
    transition: filter 0.3s ease;
  }
  #arrow:hover {
    filter: drop-shadow(0 0 8px gold);
  }
  #resultMessage {
    margin-top: 15px;
    font-size: 22px;
    font-weight: bold;
    text-align: center;
    min-height: 30px;
    color: gold;
    text-shadow: 0 0 5px #fff;
  }

  /* Анимация взрыва */
  @keyframes explosion {
    0% { transform: scale(1); opacity: 1; }
    50% { transform: scale(2); opacity: 0.8; }
    100% { transform: scale(0); opacity: 0; }
  }
  .explosion {
    position: absolute;
    width: 80px;
    height: 80px;
    border-radius: 50%;
    background: radial-gradient(circle, #ff0 0%, #f00 70%, transparent 100%);
    animation: explosion 0.6s forwards;
    pointer-events: none;
    z-index: 100;
  }

  /* Анимация подсветки ячейки */
  @keyframes highlightGreen {
    0% { box-shadow: 0 0 0px #0f0; }
    50% { box-shadow: 0 0 20px #0f0; }
    100% { box-shadow: 0 0 0px #0f0; }
  }
  @keyframes highlightRed {
    0% { box-shadow: 0 0 0px #f00; }
    50% { box-shadow: 0 0 20px #f00; }
    100% { box-shadow: 0 0 0px #f00; }
  }
  .highlight-green { animation: highlightGreen 0.6s ease-in-out; }
  .highlight-red { animation: highlightRed 0.6s ease-in-out; }

  /* Подсветка сектора рулетки */
  @keyframes sectorFlash {
    0% { opacity: 0; }
    50% { opacity: 0.7; }
    100% { opacity: 0; }
  }
  .highlight-sector {
    position: absolute;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    pointer-events: none;
    opacity: 0.7;
    animation: sectorFlash 0.6s ease-in-out forwards;
    z-index: 5;
  }
  .highlight-green-sector { background: rgba(0,255,0,0.4); }
  .highlight-red-sector { background: rgba(255,0,0,0.4); }
</style>
</head>
<body>

<!-- АУДИО ДЛЯ ВЗРЫВА — ФАЙЛ ДОЛЖЕН ЛЕЖАТЬ В ОДНОЙ ПАПКЕ С ЭТИМ HTML -->
<audio id="bombSound" src="soundbomb.mp3" preload="auto"></audio>

<div id="container">
  <div id="leftSide">
    <h1 onclick="location.reload()">EXTRIM Прокачки</h1>

    <div id="buttonsWrapper">
      <div id="twitchBtn" class="channel-btn active">
        <img src="https://cdn.discordapp.com/attachments/1374833926157107230/1404918424618143866/twitch_logo_icon_189242.png?ex=68a42ffe&is=68a2de7e&hm=c9ecfda3cad977d4dc861b4cf29df0c18b54b7e82b3736a6a2eb19c9cf026f42&" alt="Twitch" />
        Twitch
      </div>
      <div id="youtubeBtn" class="channel-btn">
        <img src="https://upload.wikimedia.org/wikipedia/commons/4/42/YouTube_icon_%282013-2017%29.png" alt="YouTube" />
        YouTube
      </div>
    </div>

    <div id="grid"></div>

    <div id="buttonsBottom">
      <button id="rouletteBtn" disabled>Запустить рулетку</button>
      <button id="showAllBtn" disabled>Показать все ячейки</button>
    </div>

    <div id="resultMessage"></div>
  </div>

  <div id="rouletteWrapper">
    <div id="rouletteWheel">
      <div id="labelCombined"><span class="red">Сгорело</span> | <span class="green">x2</span></div>
    </div>
    <div id="arrow" title="Стрелка рулетки (наведение)"></div>
  </div>
</div>

<script>
const grid = document.getElementById('grid');
const twitchBtn = document.getElementById('twitchBtn');
const youtubeBtn = document.getElementById('youtubeBtn');
const rouletteBtn = document.getElementById('rouletteBtn');
const showAllBtn = document.getElementById('showAllBtn');
const rouletteWheel = document.getElementById('rouletteWheel');
const resultMessage = document.getElementById('resultMessage');
const bombSound = document.getElementById('bombSound');

const twitchRewards = [1000, 1500, 2000, 2500, 3000, 5000];
const youtubeRewards = [1000, 1500, 2000, 2500, 5000, 10000];
const twitchChances = [0.4, 0.25, 0.175, 0.125, 0.075, 0.125];
const youtubeChances = [0.3, 0.3, 0.25, 0.125, 0.09, 0.06];

let rewards = twitchRewards;
let chances = twitchChances;

const cellsCount = 64;
let cellsData = [];
let selectedCellIndex = null;
let gameOver = false;
let rouletteSpinning = false;

function createGrid() {
  grid.innerHTML = '';
  cellsData = [];
  selectedCellIndex = null;
  gameOver = false;
  rouletteSpinning = false;
  rouletteBtn.disabled = true;
  showAllBtn.disabled = true;
  resultMessage.textContent = '';

  twitchBtn.classList.remove('disabled');
  youtubeBtn.classList.remove('disabled');

  for (let i = 0; i < cellsCount; i++) {
    const cell = document.createElement('div');
    cell.classList.add('cell');
    cell.dataset.index = i;
    cell.addEventListener('click', onCellClick);
    grid.appendChild(cell);
  }

  generateCellsData();
}

function generateCellsData() {
  cellsData = [];
  const guaranteedIndex = Math.floor(Math.random() * cellsCount);

  for (let i = 0; i < cellsCount; i++) {
    if (i === guaranteedIndex) {
      cellsData.push({ type: 'reward', value: rewards[rewards.length - 1] });
    } else {
      const bombChance = 0.11;
      if (Math.random() < bombChance) {
        cellsData.push({ type: 'bomb' });
      } else {
        cellsData.push({ type: 'reward', value: getRandomReward() });
      }
    }
  }
}

function getRandomReward() {
  let r = Math.random();
  let sum = 0;
  for (let i = 0; i < chances.length; i++) {
    sum += chances[i];
    if (r <= sum) return rewards[i];
  }
  return rewards[0];
}

function createExplosion(cell) {
  const rect = cell.getBoundingClientRect();
  const explosion = document.createElement('div');
  explosion.classList.add('explosion');
  explosion.style.left = rect.left + window.scrollX + 'px';
  explosion.style.top = rect.top + window.scrollY + 'px';
  document.body.appendChild(explosion);
  setTimeout(() => explosion.remove(), 600);

  // ЗВУК ТОЛЬКО ПРИ КЛИКЕ НА БОМБУ
  if (bombSound) {
    try {
      bombSound.currentTime = 0;
      bombSound.play();
    } catch (e) {
      // в некоторых браузерах блокировка автоплея — но у нас есть клик, так что ок
      console.warn('Не удалось воспроизвести звук:', e);
    }
  }
}

function onCellClick(e) {
  if (gameOver || rouletteSpinning) return;
  if (selectedCellIndex !== null) return;

  const cell = e.currentTarget;
  const index = +cell.dataset.index;
  if (cell.classList.contains('opened')) return;

  cell.classList.add('opened');
  selectedCellIndex = index;
  showAllBtn.disabled = false;

  const data = cellsData[index];
  if (data.type === 'bomb') {
    cell.textContent = '💣';
    cell.classList.add('bomb');
    createExplosion(cell); 
    gameOver = true;
    rouletteBtn.disabled = true;
    twitchBtn.classList.add('disabled');
    youtubeBtn.classList.add('disabled');
    twitchBtn.classList.remove('active');
    youtubeBtn.classList.remove('active');
    resultMessage.textContent = 'Взорвалась бомба! Игра окончена.';
  } else {
    cell.textContent = data.value;
    rouletteBtn.disabled = false;
    resultMessage.textContent = '';
  }
}

twitchBtn.addEventListener('click', () => {
  if (gameOver || rouletteSpinning) return;
  if (selectedCellIndex !== null) return;
  rewards = twitchRewards;
  chances = twitchChances;
  twitchBtn.classList.add('active');
  youtubeBtn.classList.remove('active');
  createGrid();
});

youtubeBtn.addEventListener('click', () => {
  if (gameOver || rouletteSpinning) return;
  if (selectedCellIndex !== null) return;
  rewards = youtubeRewards;
  chances = youtubeChances;
  youtubeBtn.classList.add('active');
  twitchBtn.classList.remove('active');
  createGrid();
});

rouletteBtn.addEventListener('click', () => {
  if (rouletteSpinning || selectedCellIndex === null) return;

  rouletteSpinning = true;
  rouletteBtn.disabled = true;
  twitchBtn.classList.add('disabled');
  youtubeBtn.classList.add('disabled');

  resultMessage.textContent = 'Рулетка крутится...';

  const spins = 3 + Math.random() * 3;
  const baseAngle = Math.random() * 360;
  const offset = 90; 
  const stopAngle = 360 * spins + baseAngle;

  rouletteWheel.style.transition = 'transform 5s cubic-bezier(0.25, 0.1, 0.25, 1)';
  rouletteWheel.style.transform = `rotate(${stopAngle}deg)`;

  setTimeout(() => {
    rouletteSpinning = false;
    const finalAngle = (stopAngle + offset) % 360;
    let isGreen = finalAngle >= 0 && finalAngle < 180;

    // Подсветка сектора рулетки
    const highlightSector = document.createElement('div');
    highlightSector.classList.add('highlight-sector');
    highlightSector.classList.add(isGreen ? 'highlight-green-sector' : 'highlight-red-sector');
    rouletteWheel.appendChild(highlightSector);
    setTimeout(() => highlightSector.remove(), 600);

    const cell = grid.children[selectedCellIndex];
    if (isGreen) {
      const currentValue = parseInt(cell.textContent) || 0;
      const newValue = currentValue * 2;
      cell.textContent = newValue;
      resultMessage.innerHTML = `Поздравляем! Награда удвоена: <span style="color:#0f0;">${newValue}</span>`;
      cell.classList.add('highlight-green');
      setTimeout(() => cell.classList.remove('highlight-green'), 600);
    } else {
      cell.textContent = '💔';
      cell.classList.add('bomb');
      resultMessage.innerHTML = `<span style="color:#f00;">Сумма сгорела! 😢</span>`;
      cell.classList.add('highlight-red');
      setTimeout(() => cell.classList.remove('highlight-red'), 600);
      gameOver = true;
    }
  }, 5200);
});

showAllBtn.addEventListener('click', () => {
  for (let i = 0; i < cellsCount; i++) {
    const cell = grid.children[i];
    if (cell.classList.contains('opened')) continue;
    const data = cellsData[i];
    cell.classList.add('opened');
    if (data.type === 'bomb') {
      cell.textContent = '💣';
      cell.classList.add('bomb');
    } else {
      cell.textContent = data.value;
    }
  }
  showAllBtn.disabled = true;
});

createGrid();
</script>

</body>
</html>
