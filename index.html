<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>EXTRIM Miner</title>
<style>
  body {
    margin: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: url('https://cdn.discordapp.com/attachments/1374833926157107230/1404916053280034876/photo_2025-08-12_22-54-11.jpg') no-repeat center center fixed;
    background-size: cover;
    color: white;
    display: flex;
    flex-direction: column;
    align-items: center;
    min-height: 100vh;
    padding: 10px;
  }
  h1 {
    margin: 15px 0;
    background: rgba(0,0,0,0.6);
    padding: 12px 25px;
    border-radius: 12px;
    font-weight: 700;
    font-size: 2rem;
    letter-spacing: 2px;
    text-shadow: 0 0 5px #000;
  }
  .buttons {
    margin-bottom: 15px;
    display: flex;
    gap: 20px;
  }
  button.platformBtn {
    display: flex;
    align-items: center;
    gap: 8px;
    background: #222;
    border: 2px solid transparent;
    border-radius: 10px;
    padding: 10px 18px;
    cursor: pointer;
    font-size: 18px;
    font-weight: 600;
    color: white;
    transition: border-color 0.3s ease, background 0.3s ease;
    user-select: none;
  }
  button.platformBtn img {
    width: 24px;
    height: 24px;
    object-fit: contain;
  }
  button.platformBtn.active {
    border-color: gold;
    background: rgba(255 215 0 / 0.3);
    box-shadow: 0 0 10px gold;
  }

  /* Grid of cells */
  #grid {
    display: grid;
    grid-template-columns: repeat(8, 50px);
    grid-template-rows: repeat(8, 50px);
    gap: 5px;
    margin-bottom: 20px;
  }
  .cell {
    background: rgba(255,255,255,0.15);
    border: 2px solid rgba(255,255,255,0.3);
    border-radius: 6px;
    color: white;
    font-weight: 700;
    font-size: 16px;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    user-select: none;
    transition: background-color 0.3s ease, transform 0.2s ease;
  }
  .cell:hover:not(.opened) {
    background-color: rgba(255,255,255,0.3);
    transform: scale(1.1);
  }
  .cell.opened {
    cursor: default;
    background-color: rgba(0,0,0,0.6);
  }
  .cell.bomb {
    animation: bombFlash 0.7s infinite alternate;
    background-color: #cc0000 !important;
    color: #fff !important;
  }
  @keyframes bombFlash {
    from { background-color: #cc0000; }
    to { background-color: #800000; }
  }
  .cell.reward {
    color: #90ee90;
  }
  .cell.burned {
    background-color: #800000 !important;
    color: #ff4d4d !important;
    font-size: 20px;
    user-select: none;
  }

  /* Upgrade button - removed as per last instructions */

  /* Roulette Styles */
  #rouletteWrapper {
    position: relative;
    width: 180px;
    height: 180px;
    user-select: none;
    margin-left: 30px;
    flex-shrink: 0;
  }
  #rouletteWheel {
    width: 180px;
    height: 180px;
    border-radius: 50%;
    border: 6px solid gold;
    box-shadow: 0 0 20px gold;
    transition: transform 5s cubic-bezier(0.33, 1, 0.68, 1);
    background: conic-gradient(
      #a6f5a6 0deg 180deg,  /* –∑–µ–ª—ë–Ω–∞—è –ø–æ–ª–æ–≤–∏–Ω–∞ */
      #f5a6a6 180deg 360deg /* –∫—Ä–∞—Å–Ω–∞—è –ø–æ–ª–æ–≤–∏–Ω–∞ */
    );
    position: relative;
  }
  #arrow {
    position: absolute;
    top: calc(100% - 10px);
    left: 50%;
    transform: translateX(-50%) rotate(0deg);
    width: 0;
    height: 0;
    border-left: 15px solid transparent;
    border-right: 15px solid transparent;
    border-top: 30px solid gold;
    filter: drop-shadow(0 0 3px #fff);
    z-index: 10;
  }
  #labelX2 {
    position: absolute;
    top: 50%;
    left: 10px;
    transform: translateY(-50%);
    color: #0a0;
    font-weight: 700;
    font-size: 20px;
    user-select: none;
    text-shadow: 0 0 5px #0f0;
  }
  #labelBurn {
    position: absolute;
    top: 50%;
    right: 10px;
    transform: translateY(-50%);
    color: #a00;
    font-weight: 700;
    font-size: 20px;
    user-select: none;
    text-shadow: 0 0 5px #f00;
  }

  /* Layout container */
  #mainContent {
    display: flex;
    align-items: flex-start;
    justify-content: center;
    gap: 20px;
    width: 100%;
    max-width: 800px;
  }

  /* Show hidden button */
  #showHiddenBtn {
    margin-bottom: 20px;
    padding: 10px 18px;
    font-size: 16px;
    background: gold;
    border: none;
    border-radius: 8px;
    font-weight: 700;
    cursor: pointer;
    box-shadow: 0 0 10px gold;
    user-select: none;
  }
</style>
</head>
<body>

<h1>EXTRIM Miner</h1>

<div class="buttons">
  <button id="btnTwitch" class="platformBtn active" title="–í—ã–±—Ä–∞—Ç—å Twitch">
    <img src="https://cdn.discordapp.com/attachments/1374833926157107230/1404918424618143866/twitch_logo_icon_189242.png" alt="Twitch" />
    Twitch
  </button>
  <button id="btnYouTube" class="platformBtn" title="–í—ã–±—Ä–∞—Ç—å YouTube">
    <img src="https://upload.wikimedia.org/wikipedia/commons/4/42/YouTube_icon_%282013-2017%29.png" alt="YouTube" />
    YouTube
  </button>
</div>

<div id="mainContent">

  <div id="grid"></div>

  <div id="rouletteWrapper" title="–ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –∫—Ä—É—Ç–∏—Ç—å —Ä—É–ª–µ—Ç–∫—É">
    <div id="rouletteWheel"></div>
    <div id="arrow"></div>
    <div id="labelX2">x2</div>
    <div id="labelBurn">–°–≥–æ—Ä–µ–ª–æ</div>
  </div>

</div>

<button id="showHiddenBtn" style="display:none;">–ü–æ–∫–∞–∑–∞—Ç—å —Å–∫—Ä—ã—Ç—ã–µ —è—á–µ–π–∫–∏</button>

<script>
  const grid = document.getElementById('grid');
  const btnTwitch = document.getElementById('btnTwitch');
  const btnYouTube = document.getElementById('btnYouTube');
  const rouletteWheel = document.getElementById('rouletteWheel');
  const rouletteWrapper = document.getElementById('rouletteWrapper');
  const arrow = document.getElementById('arrow');
  const showHiddenBtn = document.getElementById('showHiddenBtn');

  let platform = 'twitch'; // 'twitch' –∏–ª–∏ 'youtube'
  let cellsData = [];
  let openedCell = null;
  let rouletteSpinning = false;
  let burned = false;

  const twitchRewards = [1000, 1500, 2000, 2500, 5000];
  const twitchChances = [0.4, 0.3, 0.15, 0.1, 0.05]; // —Å—É–º–º–∞ —à–∞–Ω—Å–æ–≤ 1
  const youtubeRewards = [...twitchRewards, 10000];
  const youtubeChances = [0.4, 0.3, 0.15, 0.1, 0.04, 0.01];

  function weightedRandom(rewards, chances) {
    const r = Math.random();
    let sum = 0;
    for(let i=0; i<rewards.length; i++) {
      sum += chances[i];
      if(r <= sum) return rewards[i];
    }
    return rewards[rewards.length-1];
  }

  function generateCells() {
    cellsData = [];
    // 20% –±–æ–º–±, –æ—Å—Ç–∞–ª—å–Ω–æ–µ ‚Äî —Å—É–º–º—ã
    // –ù—É–∂–Ω–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –º–∏–Ω–∏–º—É–º –æ–¥–Ω—É —Å—É–º–º—É 5000 (–¥–ª—è —Ç–≤–∏—á–∞) –∏–ª–∏ 10000 (—é—Ç—É–±)
    let guaranteedHighValue = platform === 'twitch' ? 5000 : 10000;
    let guaranteedPlaced = false;

    for(let i=0; i<64; i++) {
      if (!guaranteedPlaced && i === 10) {
        cellsData.push({type:'reward', value: guaranteedHighValue});
        guaranteedPlaced = true;
      } else {
        if(Math.random() < 0.2) {
          cellsData.push({type:'bomb'});
        } else {
          let val;
          if(platform === 'twitch') {
            val = weightedRandom(twitchRewards, twitchChances);
          } else {
            val = weightedRandom(youtubeRewards, youtubeChances);
          }
          cellsData.push({type:'reward', value: val});
        }
      }
    }
  }

  function renderGrid() {
    grid.innerHTML = '';
    for(let i=0; i<64; i++) {
      const cell = document.createElement('div');
      cell.classList.add('cell');
      cell.dataset.index = i;
      cell.textContent = '';
      cell.addEventListener('click', () => onCellClick(cell, i));
      grid.appendChild(cell);
    }
  }

  function onCellClick(cell, idx) {
    if (openedCell || rouletteSpinning || burned) return;
    if (cell.classList.contains('opened')) return;

    openedCell = idx;
    const data = cellsData[idx];
    cell.classList.add('opened');

    if (data.type === 'bomb') {
      cell.classList.add('bomb');
      cell.textContent = 'üí£';
      burned = true;
      alert('–ë–æ–º–±–∞ –≤–∑–æ—Ä–≤–∞–ª–∞—Å—å! –ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞.');
      // –ü–æ—Å–ª–µ –±–æ–º–±—ã –±–ª–æ–∫–∏—Ä—É–µ–º —Ä—É–ª–µ—Ç–∫—É (–Ω–∏—á–µ–≥–æ –Ω–µ–ª—å–∑—è –¥–µ–ª–∞—Ç—å)
      rouletteSpinning = true;
      showHiddenBtn.style.display = 'block';
      highlightSelectedCell(cell);
    } else {
      animateNumber(cell, 0, data.value, () => {
        showHiddenBtn.style.display = 'block';
      });
      highlightSelectedCell(cell);
    }
  }

  function highlightSelectedCell(cell) {
    // –ü–æ–¥—Å–≤–µ—Ç–∏—Ç—å –∫—Ä–∞—Å–Ω—ã–º –≤—ã–±—Ä–∞–Ω–Ω—É—é —è—á–µ–π–∫—É (–µ—Å–ª–∏ –±–æ–º–±–∞)
    cell.style.boxShadow = '0 0 10px 3px red';
  }

  function animateNumber(cell, start, end, callback) {
    let current = start;
    const step = Math.ceil((end - start) / 30);
    const interval = setInterval(() => {
      current += step;
      if (current >= end) {
        current = end;
        clearInterval(interval);
        if(callback) callback();
      }
      cell.textContent = current;
    }, 40);
  }

  function spinRoulette() {
    if (rouletteSpinning || !openedCell || burned) return;

    rouletteSpinning = true;
    showHiddenBtn.disabled = true;

    // –°–ª—É—á–∞–π–Ω—ã–π —É–≥–æ–ª –¥–ª—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Ä—É–ª–µ—Ç–∫–∏ (–º–∏–Ω 3 –≤—Ä–∞—â–µ–Ω–∏—è)
    const spins = 3 + Math.floor(Math.random() * 3);
    const stopAngle = Math.random() * 360 + 360 * spins;

    rouletteWheel.style.transition = 'transform 4s cubic-bezier(0.33, 1, 0.68, 1)';
    rouletteWheel.style.transform = `rotate(${stopAngle}deg)`;

    // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –≤—ã–∏–≥—Ä—ã—à –ø–æ—Å–ª–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è –∞–Ω–∏–º–∞—Ü–∏–∏
    setTimeout(() => {
      rouletteWheel.style.transition = 'none';
      // –ü—Ä–∏–≤–æ–¥–∏–º —É–≥–æ–ª –≤ –¥–∏–∞–ø–∞–∑–æ–Ω 0-360
      const normalizedAngle = stopAngle % 360;

      // 0-180 –∑–µ–ª—ë–Ω–∞—è –∑–æ–Ω–∞ (–≤—ã–∏–≥—Ä—ã—à), 180-360 –∫—Ä–∞—Å–Ω–∞—è (—Å–≥–æ—Ä–∞–Ω–∏–µ)
      if (normalizedAngle <= 180) {
        // –≤—ã–∏–≥—Ä—ã—à —Ö2
        const cell = grid.children[openedCell];
        const val = parseInt(cell.textContent);
        const doubled = val * 2;
        animateNumber(cell, val, doubled);
      } else {
        // —Å–≥–æ—Ä–∞–Ω–∏–µ —Å—É–º–º—ã
        const cell = grid.children[openedCell];
        cell.classList.add('burned');
        cell.textContent = 'üíî –°–≥–æ—Ä–µ–ª–æ';
        burned = true;
      }

      rouletteSpinning = false;
      showHiddenBtn.disabled = false;
    }, 4100);
  }

  btnTwitch.addEventListener('click', () => {
    if (rouletteSpinning) return;
    platform = 'twitch';
    btnTwitch.classList.add('active');
    btnYouTube.classList.remove('active');
    resetGame();
  });

  btnYouTube.addEventListener('click', () => {
    if (rouletteSpinning) return;
    platform = 'youtube';
    btnYouTube.classList.add('active');
    btnTwitch.classList.remove('active');
    resetGame();
  });

  showHiddenBtn.addEventListener('click', () => {
    // –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è —è—á–µ–µ–∫
    for(let i=0; i<64; i++) {
      const cell = grid.children[i];
      if (!cell.classList.contains('opened')) {
        const data = cellsData[i];
        if (data.type === 'bomb') {
          cell.textContent = 'üí£';
          cell.classList.add('bomb');
        } else {
          cell.textContent = data.value;
          cell.classList.add('reward');
        }
        cell.classList.add('opened');
      }
    }
    showHiddenBtn.style.display = 'none';
  });

  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
  function resetGame() {
    openedCell = null;
    rouletteSpinning = false;
    burned = false;
    showHiddenBtn.style.display = 'none';
    generateCells();
    renderGrid();
    rouletteWheel.style.transition = 'none';
    rouletteWheel.style.transform = 'rotate(0deg)';
  }

  rouletteWrapper.addEventListener('click', spinRoulette);

  resetGame();
</script>

</body>
</html>
