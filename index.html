<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>EXTRIM Прокачки</title>
<link rel="icon" href="https://cdn.discordapp.com/attachments/1374833926157107230/1405185311327129701/extrim-removebg-preview.png" type="image/png">
<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: url('https://cdn.discordapp.com/attachments/1374833926157107230/1404916053280034876/photo_2025-08-12_22-54-11.jpg') no-repeat center center fixed;
  background-size: cover;
  display: flex;
  justify-content: center;
  padding: 20px;
  color: #eee;
  user-select: none;
  min-height: 100vh;
  background-color: rgba(0,0,0,0.6);
  background-blend-mode: multiply;
}
#container {
  display: flex;
  gap: 20px;
  align-items: flex-start;
}
#leftSide {
  display: flex;
  flex-direction: column;
  align-items: center;
}
h1 {
  margin-bottom: 20px;
  color: #ffd700;
  text-shadow: 0 0 10px #ffd700;
  cursor: pointer;
}
#buttonsWrapper {
  display: flex;
  gap: 20px;
  margin-bottom: 20px;
}
.channel-btn {
  padding: 10px 25px 10px 40px;
  cursor: pointer;
  background: rgba(255,255,255,0.2);
  border-radius: 10px;
  font-weight: bold;
  color: #eee;
  user-select: none;
  transition: background-color 0.3s, color 0.3s;
  position: relative;
  display: flex;
  align-items: center;
}
.channel-btn.active {
  background: gold;
  color: black;
}
.channel-btn.disabled {
  opacity: 0.5;
  cursor: not-allowed;
}
.channel-btn img {
  position: absolute;
  left: 10px;
  width: 20px;
  height: 20px;
  object-fit: contain;
  top: 50%;
  transform: translateY(-50%);
}
#grid {
  display: grid;
  grid-template-columns: repeat(8, 80px);
  grid-gap: 10px;
}
.cell {
  background: rgba(255,255,255,0.1);
  border: 2px solid rgba(255,255,255,0.3);
  border-radius: 12px;
  cursor: pointer;
  font-weight: bold;
  font-size: 24px;
  color: #b0f2b6;
  display: flex;
  align-items: center;
  justify-content: center;
  user-select: none;
  transition: background-color 0.3s, transform 0.3s;
  width: 80px;
  height: 80px;
}
.cell:hover:not(.opened) {
  background-color: rgba(50,255,50,0.3);
  transform: scale(1.1);
}
.cell.opened {
  cursor: default;
  background-color: rgba(0,0,0,0.6);
  color: #fff;
  text-shadow: 0 0 6px #0f0;
}
.cell.bomb {
  background-color: #ff3333 !important;
  color: white !important;
  text-shadow: 0 0 10px #ff0000;
}
#buttonsBottom {
  margin-top: 20px;
  display: flex;
  justify-content: center;
}
#rouletteBtn, #showAllBtn {
  padding: 12px 28px;
  font-size: 18px;
  border-radius: 12px;
  border: none;
  cursor: pointer;
  font-weight: bold;
  margin: 0 10px;
}
#rouletteBtn {
  background: gold;
  color: black;
}
#rouletteBtn:disabled {
  background: #666;
  color: #ccc;
  cursor: not-allowed;
}
#showAllBtn {
  background: #444;
  color: #eee;
}
#showAllBtn:disabled {
  background: #222;
  cursor: not-allowed;
  color: #555;
}
#rouletteWrapper {
  position: relative;
  width: 240px;
  height: 240px;
  user-select: none;
}
#rouletteWheel {
  width: 240px;
  height: 240px;
  border-radius: 50%;
  border: 8px solid gold;
  box-shadow: 0 0 30px gold;
  background: conic-gradient(
    #a6f5a6 0deg 180deg,
    #f5a6a6 180deg 360deg
  );
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  font-weight: bold;
  font-size: 18px;
  user-select: none;
  text-shadow: 0 0 5px #000;
  color: #fff;
}
#labelCombined {
  user-select: none;
  pointer-events: none;
  color: #fff;
  display: flex;
  gap: 8px;
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
}
#labelCombined .red { color: #a00; text-shadow: 0 0 8px #f00; }
#labelCombined .green { color: #0a0; text-shadow: 0 0 8px #0f0; }
#arrow {
  position: absolute;
  top: 50%;
  right: -50px;
  transform: translateY(-50%) rotate(-90deg);
  width: 0;
  height: 0;
  border-left: 15px solid transparent;
  border-right: 15px solid transparent;
  border-bottom: 30px solid gold;
  filter: drop-shadow(0 0 3px #fff);
  z-index: 10;
  cursor: pointer;
  transition: filter 0.3s ease;
}
#arrow:hover { filter: drop-shadow(0 0 8px gold); }
#resultMessage {
  margin-top: 15px;
  font-size: 22px;
  font-weight: bold;
  text-align: center;
  min-height: 30px;
  color: gold;
  text-shadow: 0 0 5px #fff;
}
.explosion {
  position: absolute;
  width: 100px;
  height: 100px;
  background: radial-gradient(circle, #ff0, #f00);
  border-radius: 50%;
  pointer-events: none;
  animation: explode 0.6s ease-out forwards;
  z-index: 1000;
}
@keyframes explode { 0% { transform: scale(0.5); opacity: 1; } 100% { transform: scale(2); opacity: 0; } }
.highlight-green { animation: highlightGreen 0.6s; }
.highlight-red { animation: highlightRed 0.6s; }
@keyframes highlightGreen { 0% { background-color: #0f0; } 100% { background-color: rgba(255,255,255,0.1); } }
@keyframes highlightRed { 0% { background-color: #f00; } 100% { background-color: rgba(255,255,255,0.1); } }
.highlight-sector { position: absolute; top: 0; left:0; width: 100%; height: 100%; border-radius: 50%; opacity: 0.6; }
.highlight-green-sector { background: conic-gradient(#0f0 0deg 180deg, transparent 180deg 360deg); }
.highlight-red-sector { background: conic-gradient(#f00 0deg 180deg, transparent 180deg 360deg); }
#historyWrapper { width: 200px; margin-right: 20px; display: flex; flex-direction: column; align-items: stretch; }
#historyBtn { padding: 10px; font-weight: bold; cursor: pointer; border-radius: 8px; border: none; background: gold; color: black; margin-bottom: 5px; }
#historyList { max-height: 400px; overflow-y: auto; background: rgba(0,0,0,0.6); border-radius: 8px; padding: 10px; display: none; flex-direction: column; gap: 5px; color: #fff; font-size: 14px; }
.history-item { padding: 5px; border-radius: 6px; background: rgba(255,255,255,0.1); }
.history-item.bomb { background: rgba(255,0,0,0.3); }
.history-item.roulette-loss { background: rgba(255,100,0,0.3); }
.history-item.roulette-win { background: rgba(0,255,0,0.3); }
</style>
</head>
<body>

<div id="container">
  <div id="historyWrapper">
    <button id="historyBtn">Последние победы</button>
    <div id="historyList"></div>
  </div>

  <div id="leftSide">
    <h1 id="titleHeader">EXTRIM Прокачки</h1>
    <div id="buttonsWrapper">
      <div id="twitchBtn" class="channel-btn active">
        <img src="https://cdn.discordapp.com/attachments/1374833926157107230/1404918424618143866/twitch_logo_icon_189242.png" alt="Twitch" />
        Twitch
      </div>
      <div id="youtubeBtn" class="channel-btn">
        <img src="https://upload.wikimedia.org/wikipedia/commons/4/42/YouTube_icon_%282013-2017%29.png" alt="YouTube" />
        YouTube
      </div>
    </div>
    <div id="grid"></div>
    <div id="buttonsBottom">
      <button id="rouletteBtn" disabled>Запустить рулетку</button>
      <button id="showAllBtn" disabled>Показать все ячейки</button>
    </div>
    <div id="resultMessage"></div>
  </div>

  <div id="rouletteWrapper">
    <div id="rouletteWheel">
      <div id="labelCombined"><span class="red">Сгорело</span> | <span class="green">x2</span></div>
    </div>
    <div id="arrow" title="Стрелка рулетки (наведение)"></div>
  </div>
</div>

<script>
const grid=document.getElementById('grid');
const twitchBtn=document.getElementById('twitchBtn');
const youtubeBtn=document.getElementById('youtubeBtn');
const rouletteBtn=document.getElementById('rouletteBtn');
const showAllBtn=document.getElementById('showAllBtn');
const rouletteWheel=document.getElementById('rouletteWheel');
const resultMessage=document.getElementById('resultMessage');
const historyBtn=document.getElementById('historyBtn');
const historyList=document.getElementById('historyList');
const titleHeader=document.getElementById('titleHeader');

titleHeader.addEventListener('click',()=>location.reload());
historyBtn.addEventListener('click',()=>{ historyList.style.display = historyList.style.display==='flex'?'none':'flex'; });

const twitchRewards=[1000,1500,2000,2500,3000,5000];
const youtubeRewards=[1000,1500,2000,2500,5000,10000];
const twitchChances=[0.4,0.25,0.175,0.125,0.075,0.125];
const youtubeChances=[0.3,0.3,0.2,0.12,0.09,0.06];

let rewards=twitchRewards;
let chances=twitchChances;

const cellsCount=64;
let cellsData=[];
let selectedCellIndex=null;
let gameOver=false;
let rouletteSpinning=false;

function createGrid(){
  grid.innerHTML='';
  cellsData=[];
  selectedCellIndex=null;
  gameOver=false;
  rouletteSpinning=false;
  rouletteBtn.disabled=true;
  showAllBtn.disabled=true;
  resultMessage.textContent='';

  twitchBtn.classList.remove('disabled');
  youtubeBtn.classList.remove('disabled');

  for(let i=0;i<cellsCount;i++){
    const cell=document.createElement('div');
    cell.classList.add('cell');
    cell.dataset.index=i;
    cell.addEventListener('click',onCellClick);
    grid.appendChild(cell);
  }
  generateCellsData();
}

function generateCellsData(){
  cellsData=[];
  const guaranteedIndex=Math.floor(Math.random()*cellsCount);
  for(let i=0;i<cellsCount;i++){
    if(i===guaranteedIndex){
      cellsData.push({type:'reward',value:rewards[rewards.length-1]});
    } else {
      const bombChance=0.08;
      if(Math.random()<bombChance){
        cellsData.push({type:'bomb'});
      } else {
        cellsData.push({type:'reward',value:getRandomReward()});
      }
    }
  }
}

function getRandomReward(){
  let r=Math.random();
  let sum=0;
  for(let i=0;i<chances.length;i++){
    sum+=chances[i];
    if(r<=sum) return rewards[i];
  }
  return rewards[0];
}

function saveHistory(){
  const items=[];
  document.querySelectorAll('#historyList .history-item').forEach(el=>{
    items.push({text:el.textContent,type:el.classList.contains('bomb')?'bomb':el.classList.contains('roulette-loss')?'roulette-loss':'roulette-win'});
  });
  localStorage.setItem('extrimHistory',JSON.stringify(items));
}

function loadHistory(){
  const saved=localStorage.getItem('extrimHistory');
  if(saved){
    const items=JSON.parse(saved);
    historyList.innerHTML='';
    items.forEach(item=>{
      const entry=document.createElement('div');
      entry.classList.add('history-item');
      if(item.type) entry.classList.add(item.type);
      entry.textContent=item.text;
      historyList.appendChild(entry);
    });
  }
}

function addHistoryEntry(text,type){
  const entry=document.createElement('div');
  entry.classList.add('history-item');
  if(type) entry.classList.add(type);
  entry.textContent=text;
  historyList.prepend(entry);

  const allItems = Array.from(historyList.children);
  const rouletteItems = allItems.filter(item => item.classList.contains('roulette-win') || item.classList.contains('roulette-loss'));
  while(rouletteItems.length > 5){
    const last = rouletteItems.pop();
    historyList.removeChild(last);
  }

  saveHistory();
}

function onCellClick(e){
  if(gameOver||rouletteSpinning) return;
  if(selectedCellIndex!==null) return;
  const cell=e.currentTarget;
  const index=+cell.dataset.index;
  if(cell.classList.contains('opened')) return;

  cell.classList.add('opened');
  selectedCellIndex=index;
  showAllBtn.disabled=false;

  const data=cellsData[index];
  if(data.type==='bomb'){
    cell.textContent='💣';
    cell.classList.add('bomb');
    gameOver=true;
    rouletteBtn.disabled=true;
    twitchBtn.classList.add('disabled');
    youtubeBtn.classList.add('disabled');
    twitchBtn.classList.remove('active');
    youtubeBtn.classList.remove('active');
    resultMessage.textContent='Взорвалась бомба! Игра окончена.';

    const explosion=document.createElement('div');
    explosion.classList.add('explosion');
    const rect=cell.getBoundingClientRect();
    explosion.style.left=`${rect.left+rect.width/2-50+window.scrollX}px`;
    explosion.style.top=`${rect.top+rect.height/2-50+window.scrollY}px`;
    document.body.appendChild(explosion);
    setTimeout(()=>document.body.removeChild(explosion),600);

    addHistoryEntry(`Ячейка ${selectedCellIndex+1}: 💣`,'bomb');
  } else {
    cell.textContent=data.value;
    rouletteBtn.disabled=false;
    resultMessage.textContent='';
  }
}

twitchBtn.addEventListener('click',()=>{
  if(gameOver||rouletteSpinning) return;
  if(selectedCellIndex!==null) return;
  rewards=twitchRewards;
  chances=twitchChances;
  twitchBtn.classList.add('active');
  youtubeBtn.classList.remove('active');
  createGrid();
});

youtubeBtn.addEventListener('click',()=>{
  if(gameOver||rouletteSpinning) return;
  if(selectedCellIndex!==null) return;
  rewards=youtubeRewards;
  chances=youtubeChances;
  youtubeBtn.classList.add('active');
  twitchBtn.classList.remove('active');
  createGrid();
});

rouletteBtn.addEventListener('click',()=>{
  if(rouletteSpinning||selectedCellIndex===null) return;

  rouletteSpinning=true;
  rouletteBtn.disabled=true;
  twitchBtn.classList.add('disabled');
  youtubeBtn.classList.add('disabled');
  resultMessage.textContent='Рулетка крутится...';

  const spins=3+Math.random()*3;
  const baseAngle=Math.random()*360;
  const offset=90; 
  const stopAngle=360*spins+baseAngle;

  rouletteWheel.style.transition='transform 5s cubic-bezier(0.25,0.1,0.25,1)';
  rouletteWheel.style.transform=`rotate(${stopAngle}deg)`;

  setTimeout(()=>{
    rouletteSpinning=false;
    const finalAngle=(stopAngle+offset)%360;
    let isGreen=finalAngle>=0 && finalAngle<180;

    const cell=grid.children[selectedCellIndex];
    if(isGreen){
      const currentValue=parseInt(cell.textContent)||0;
      const newValue=currentValue*2;
      cell.textContent=newValue;
      resultMessage.innerHTML=`Поздравляем! Награда удвоена: <span style="color:#0f0;">${newValue}</span>`;
      addHistoryEntry(`Ячейка ${selectedCellIndex+1}: ${newValue} ✅`,'roulette-win');

      cell.classList.add('highlight-green');
      setTimeout(()=>cell.classList.remove('highlight-green'),600);
    } else {
      cell.textContent='0';
      resultMessage.innerHTML=`Сгорело! Награда потеряна 💀`;
      addHistoryEntry(`Ячейка ${selectedCellIndex+1}: 0 ❌`,'roulette-loss');

      cell.classList.add('highlight-red');
      setTimeout(()=>cell.classList.remove('highlight-red'),600);
    }

    showAllBtn.disabled=false;
  },5000);
});

showAllBtn.addEventListener('click',()=>{
  for(let i=0;i<cellsCount;i++){
    const cell=grid.children[i];
    if(!cell.classList.contains('opened')){
      const data=cellsData[i];
      cell.classList.add('opened');
      cell.textContent=data.type==='bomb'?'💣':data.value;
      if(data.type==='bomb') cell.classList.add('bomb');
    }
  }
  showAllBtn.disabled=true;
});

createGrid();
loadHistory();
</script>
</body>
</html>
